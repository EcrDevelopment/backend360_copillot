# Generated by Django 5.2.5 on 2026-01-02 15:17

import django.db.models.deletion
import simple_history.models
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('auth', '0012_alter_user_first_name_max_length'),
        ('usuarios', '0009_usuariospermissions'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='MantenimientoPermissions',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
            ],
            options={
                'verbose_name': 'Permiso de Mantenimiento',
                'verbose_name_plural': 'Permisos de Mantenimiento',
                'permissions': [('can_manage_maintenance_tables', 'Puede gestionar todas las tablas de mantenimiento'), ('can_view_maintenance_tables', 'Puede ver tablas de mantenimiento'), ('can_manage_document_types', 'Puede gestionar tipos de documentos'), ('can_manage_companies', 'Puede gestionar empresas'), ('can_manage_product_catalog', 'Puede gestionar catálogo de productos'), ('can_manage_warehouse_catalog', 'Puede gestionar catálogo de almacenes'), ('can_manage_stowage_types', 'Puede gestionar tipos de estibaje')],
                'managed': False,
                'default_permissions': (),
            },
        ),
        migrations.CreateModel(
            name='ProveedorPermissions',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
            ],
            options={
                'verbose_name': 'Permiso de Proveedor',
                'verbose_name_plural': 'Permisos de Proveedor',
                'permissions': [('can_upload_documents', 'Puede cargar documentos DUA'), ('can_manage_own_documents', 'Puede gestionar sus propios documentos'), ('can_view_own_documents', 'Puede ver sus propios documentos'), ('can_download_own_documents', 'Puede descargar sus propios documentos')],
                'managed': False,
                'default_permissions': (),
            },
        ),
        migrations.CreateModel(
            name='CustomPermissionCategory',
            fields=[
                ('state', models.BooleanField(default=True, verbose_name='Estado')),
                ('created_date', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),
                ('modified_date', models.DateTimeField(auto_now=True, verbose_name='Fecha de Modificación')),
                ('deleted_date', models.DateTimeField(blank=True, null=True, verbose_name='Fecha de Eliminación')),
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('name', models.CharField(help_text='Nombre técnico de la categoría (ej: ventas, finanzas)', max_length=100, unique=True)),
                ('display_name', models.CharField(help_text='Nombre para mostrar en UI (ej: Ventas, Finanzas)', max_length=200)),
                ('description', models.TextField(blank=True, help_text='Descripción de qué permisos agrupa esta categoría')),
                ('icon', models.CharField(blank=True, help_text='Nombre del ícono para el frontend', max_length=50)),
                ('order', models.IntegerField(default=0, help_text='Orden de visualización')),
            ],
            options={
                'verbose_name': 'Categoría de Permiso',
                'verbose_name_plural': 'Categorías de Permisos',
                'db_table': 'custom_permission_category',
                'ordering': ['order', 'display_name'],
            },
        ),
        migrations.AlterModelOptions(
            name='usuariospermissions',
            options={'default_permissions': (), 'managed': False, 'permissions': [('can_manage_users', 'Puede gestionar usuarios (crear, editar, eliminar)'), ('can_view_users', 'Puede ver usuarios'), ('can_manage_roles', 'Puede gestionar roles y permisos'), ('can_view_roles', 'Puede ver roles y permisos'), ('can_create_users', 'Puede crear usuarios'), ('can_edit_users', 'Puede editar usuarios'), ('can_delete_users', 'Puede eliminar usuarios'), ('can_create_roles', 'Puede crear roles'), ('can_edit_roles', 'Puede editar roles'), ('can_delete_roles', 'Puede eliminar roles')], 'verbose_name': 'Permiso de Usuarios', 'verbose_name_plural': 'Permisos de Usuarios'},
        ),
        migrations.CreateModel(
            name='CustomPermission',
            fields=[
                ('state', models.BooleanField(default=True, verbose_name='Estado')),
                ('created_date', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),
                ('modified_date', models.DateTimeField(auto_now=True, verbose_name='Fecha de Modificación')),
                ('deleted_date', models.DateTimeField(blank=True, null=True, verbose_name='Fecha de Eliminación')),
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('codename', models.CharField(help_text="Código del permiso (ej: can_manage_sales). Debe empezar con 'can_'", max_length=100, unique=True)),
                ('name', models.CharField(help_text='Nombre descriptivo del permiso (ej: Puede gestionar ventas)', max_length=255)),
                ('description', models.TextField(blank=True, help_text='Descripción detallada de qué permite hacer')),
                ('permission_type', models.CharField(choices=[('modular', 'Modular (alto nivel)'), ('granular', 'Granular (acción específica)')], default='modular', help_text='Tipo de permiso: modular (alto nivel) o granular (específico)', max_length=20)),
                ('action_type', models.CharField(choices=[('manage', 'Gestionar (crear/editar/eliminar)'), ('view', 'Ver (solo lectura)'), ('create', 'Crear'), ('edit', 'Editar'), ('delete', 'Eliminar'), ('approve', 'Aprobar'), ('export', 'Exportar'), ('import', 'Importar'), ('custom', 'Personalizado')], default='manage', help_text='Tipo de acción que permite', max_length=20)),
                ('is_system', models.BooleanField(default=False, help_text='Si es True, el permiso no puede ser eliminado (permisos del sistema)')),
                ('django_permission', models.OneToOneField(blank=True, help_text='Permiso nativo de Django asociado', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='custom_permission', to='auth.permission')),
                ('parent_permission', models.ForeignKey(blank=True, help_text='Permiso padre en la jerarquía (ej: can_manage_sales incluye can_create_sales)', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='child_permissions', to='usuarios.custompermission')),
                ('category', models.ForeignKey(help_text='Categoría a la que pertenece este permiso', on_delete=django.db.models.deletion.CASCADE, related_name='permissions', to='usuarios.custompermissioncategory')),
            ],
            options={
                'verbose_name': 'Permiso Personalizado',
                'verbose_name_plural': 'Permisos Personalizados',
                'db_table': 'custom_permission',
                'ordering': ['category__order', 'permission_type', 'name'],
            },
        ),
        migrations.CreateModel(
            name='HistoricalCustomPermission',
            fields=[
                ('state', models.BooleanField(default=True, verbose_name='Estado')),
                ('created_date', models.DateTimeField(blank=True, editable=False, verbose_name='Fecha de Creación')),
                ('modified_date', models.DateTimeField(blank=True, editable=False, verbose_name='Fecha de Modificación')),
                ('deleted_date', models.DateTimeField(blank=True, null=True, verbose_name='Fecha de Eliminación')),
                ('id', models.IntegerField(blank=True, db_index=True)),
                ('codename', models.CharField(db_index=True, help_text="Código del permiso (ej: can_manage_sales). Debe empezar con 'can_'", max_length=100)),
                ('name', models.CharField(help_text='Nombre descriptivo del permiso (ej: Puede gestionar ventas)', max_length=255)),
                ('description', models.TextField(blank=True, help_text='Descripción detallada de qué permite hacer')),
                ('permission_type', models.CharField(choices=[('modular', 'Modular (alto nivel)'), ('granular', 'Granular (acción específica)')], default='modular', help_text='Tipo de permiso: modular (alto nivel) o granular (específico)', max_length=20)),
                ('action_type', models.CharField(choices=[('manage', 'Gestionar (crear/editar/eliminar)'), ('view', 'Ver (solo lectura)'), ('create', 'Crear'), ('edit', 'Editar'), ('delete', 'Eliminar'), ('approve', 'Aprobar'), ('export', 'Exportar'), ('import', 'Importar'), ('custom', 'Personalizado')], default='manage', help_text='Tipo de acción que permite', max_length=20)),
                ('is_system', models.BooleanField(default=False, help_text='Si es True, el permiso no puede ser eliminado (permisos del sistema)')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('category', models.ForeignKey(blank=True, db_constraint=False, help_text='Categoría a la que pertenece este permiso', null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='usuarios.custompermissioncategory')),
                ('django_permission', models.ForeignKey(blank=True, db_constraint=False, help_text='Permiso nativo de Django asociado', null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='auth.permission')),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('parent_permission', models.ForeignKey(blank=True, db_constraint=False, help_text='Permiso padre en la jerarquía (ej: can_manage_sales incluye can_create_sales)', null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='usuarios.custompermission')),
            ],
            options={
                'verbose_name': 'historical Permiso Personalizado',
                'verbose_name_plural': 'historical Permisos Personalizados',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalCustomPermissionCategory',
            fields=[
                ('state', models.BooleanField(default=True, verbose_name='Estado')),
                ('created_date', models.DateTimeField(blank=True, editable=False, verbose_name='Fecha de Creación')),
                ('modified_date', models.DateTimeField(blank=True, editable=False, verbose_name='Fecha de Modificación')),
                ('deleted_date', models.DateTimeField(blank=True, null=True, verbose_name='Fecha de Eliminación')),
                ('id', models.IntegerField(blank=True, db_index=True)),
                ('name', models.CharField(db_index=True, help_text='Nombre técnico de la categoría (ej: ventas, finanzas)', max_length=100)),
                ('display_name', models.CharField(help_text='Nombre para mostrar en UI (ej: Ventas, Finanzas)', max_length=200)),
                ('description', models.TextField(blank=True, help_text='Descripción de qué permisos agrupa esta categoría')),
                ('icon', models.CharField(blank=True, help_text='Nombre del ícono para el frontend', max_length=50)),
                ('order', models.IntegerField(default=0, help_text='Orden de visualización')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical Categoría de Permiso',
                'verbose_name_plural': 'historical Categorías de Permisos',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='HistoricalPermissionChangeAudit',
            fields=[
                ('state', models.BooleanField(default=True, verbose_name='Estado')),
                ('created_date', models.DateTimeField(blank=True, editable=False, verbose_name='Fecha de Creación')),
                ('modified_date', models.DateTimeField(blank=True, editable=False, verbose_name='Fecha de Modificación')),
                ('deleted_date', models.DateTimeField(blank=True, null=True, verbose_name='Fecha de Eliminación')),
                ('id', models.IntegerField(blank=True, db_index=True)),
                ('action', models.CharField(choices=[('created', 'Creado'), ('updated', 'Actualizado'), ('deleted', 'Eliminado'), ('assigned', 'Asignado a usuario/grupo'), ('revoked', 'Revocado de usuario/grupo')], help_text='Tipo de acción realizada', max_length=20)),
                ('before_value', models.JSONField(blank=True, help_text='Valor antes del cambio (para updates)', null=True)),
                ('after_value', models.JSONField(blank=True, help_text='Valor después del cambio (para updates)', null=True)),
                ('reason', models.TextField(blank=True, help_text='Razón del cambio (opcional)')),
                ('ip_address', models.GenericIPAddressField(blank=True, help_text='Dirección IP desde donde se realizó el cambio', null=True)),
                ('user_agent', models.TextField(blank=True, help_text='User agent del navegador/cliente')),
                ('history_id', models.AutoField(primary_key=True, serialize=False)),
                ('history_date', models.DateTimeField(db_index=True)),
                ('history_change_reason', models.CharField(max_length=100, null=True)),
                ('history_type', models.CharField(choices=[('+', 'Created'), ('~', 'Changed'), ('-', 'Deleted')], max_length=1)),
                ('history_user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('performed_by', models.ForeignKey(blank=True, db_constraint=False, help_text='Usuario que realizó el cambio', null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL)),
                ('permission', models.ForeignKey(blank=True, db_constraint=False, help_text='Permiso afectado por este cambio', null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='usuarios.custompermission')),
                ('target_group', models.ForeignKey(blank=True, db_constraint=False, help_text='Grupo al que se le asignó/revocó el permiso (si aplica)', null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to='auth.group')),
                ('target_user', models.ForeignKey(blank=True, db_constraint=False, help_text='Usuario al que se le asignó/revocó el permiso (si aplica)', null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'historical Auditoría de Permiso',
                'verbose_name_plural': 'historical Auditorías de Permisos',
                'ordering': ('-history_date', '-history_id'),
                'get_latest_by': ('history_date', 'history_id'),
            },
            bases=(simple_history.models.HistoricalChanges, models.Model),
        ),
        migrations.CreateModel(
            name='PermissionChangeAudit',
            fields=[
                ('state', models.BooleanField(default=True, verbose_name='Estado')),
                ('created_date', models.DateTimeField(auto_now_add=True, verbose_name='Fecha de Creación')),
                ('modified_date', models.DateTimeField(auto_now=True, verbose_name='Fecha de Modificación')),
                ('deleted_date', models.DateTimeField(blank=True, null=True, verbose_name='Fecha de Eliminación')),
                ('id', models.AutoField(primary_key=True, serialize=False)),
                ('action', models.CharField(choices=[('created', 'Creado'), ('updated', 'Actualizado'), ('deleted', 'Eliminado'), ('assigned', 'Asignado a usuario/grupo'), ('revoked', 'Revocado de usuario/grupo')], help_text='Tipo de acción realizada', max_length=20)),
                ('before_value', models.JSONField(blank=True, help_text='Valor antes del cambio (para updates)', null=True)),
                ('after_value', models.JSONField(blank=True, help_text='Valor después del cambio (para updates)', null=True)),
                ('reason', models.TextField(blank=True, help_text='Razón del cambio (opcional)')),
                ('ip_address', models.GenericIPAddressField(blank=True, help_text='Dirección IP desde donde se realizó el cambio', null=True)),
                ('user_agent', models.TextField(blank=True, help_text='User agent del navegador/cliente')),
                ('performed_by', models.ForeignKey(help_text='Usuario que realizó el cambio', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='permission_changes_made', to=settings.AUTH_USER_MODEL)),
                ('permission', models.ForeignKey(help_text='Permiso afectado por este cambio', on_delete=django.db.models.deletion.CASCADE, related_name='audit_logs', to='usuarios.custompermission')),
                ('target_group', models.ForeignKey(blank=True, help_text='Grupo al que se le asignó/revocó el permiso (si aplica)', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='permission_changes', to='auth.group')),
                ('target_user', models.ForeignKey(blank=True, help_text='Usuario al que se le asignó/revocó el permiso (si aplica)', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='permission_changes_received', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Auditoría de Permiso',
                'verbose_name_plural': 'Auditorías de Permisos',
                'db_table': 'permission_change_audit',
                'ordering': ['-created_date'],
            },
        ),
    ]
